<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AttendPro | Employee Attendance System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #1abc9c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --gray: #95a5a6;
            --white: #ffffff;
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
            --sidebar-width: 260px;
            --sidebar-collapsed: 80px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: var(--dark);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--primary);
            color: white;
            transition: var(--transition);
            box-shadow: 3px 0 15px rgba(0, 0, 0, 0.1);
            z-index: 100;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar.collapsed {
            width: var(--sidebar-collapsed);
        }

        .logo-container {
            padding: 20px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 80px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            transition: var(--transition);
            opacity: 1;
        }

        .sidebar.collapsed .logo {
            opacity: 0;
            transform: scale(0.8);
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .logo h1 {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            font-size: 20px;
            color: white;
        }

        .logo span {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.7);
            display: block;
            margin-top: -2px;
        }

        .sidebar-toggle {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 14px;
        }

        .sidebar-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .nav-item {
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            font-size: 15px;
            border-left: 4px solid transparent;
            margin: 2px 0;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(255, 255, 255, 0.1);
            border-left: 4px solid var(--accent);
        }

        .nav-item i {
            width: 20px;
            text-align: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .nav-item span {
            transition: var(--transition);
            opacity: 1;
        }

        .sidebar.collapsed .nav-item {
            justify-content: center;
            padding: 15px 0;
        }

        .sidebar.collapsed .nav-item span {
            opacity: 0;
            width: 0;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            transition: var(--transition);
            padding: 20px;
        }

        .sidebar.collapsed + .main-content {
            margin-left: var(--sidebar-collapsed);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
            background: var(--white);
            padding: 20px 25px;
            border-radius: 15px;
            box-shadow: var(--card-shadow);
        }

        .header h2 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 28px;
            color: var(--primary);
        }

        .header-subtitle {
            font-size: 14px;
            color: var(--gray);
            margin-top: 5px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .date-picker {
            display: flex;
            align-items: center;
            gap: 15px;
            background: var(--light);
            padding: 12px 20px;
            border-radius: 50px;
            border: 2px solid #e0e0e0;
            transition: var(--transition);
        }

        .date-picker:focus-within {
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .date-picker input {
            border: none;
            font-family: 'Roboto', sans-serif;
            font-size: 16px;
            background: transparent;
            outline: none;
            color: var(--dark);
        }

        .search-container {
            position: relative;
        }

        .search-container input {
            padding: 12px 20px 12px 45px;
            border-radius: 50px;
            border: 2px solid #e0e0e0;
            background: white;
            width: 250px;
            font-family: 'Roboto', sans-serif;
            font-size: 16px;
            transition: var(--transition);
        }

        .search-container input:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
            outline: none;
        }

        .search-container i {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
            background: white;
            padding: 8px 15px;
            border-radius: 50px;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            transition: var(--transition);
        }

        .user-profile:hover {
            border-color: var(--secondary);
            box-shadow: var(--card-shadow);
        }

        .user-profile img {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
        }

        /* Page Content Areas */
        .page-content {
            display: none;
        }

        .page-content.active {
            display: block;
        }

        /* Dashboard Cards */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            border: 1px solid #e0e0e0;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-header h3 {
            font-weight: 500;
            font-size: 18px;
            color: var(--dark);
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .icon-present {
            background: rgba(46, 204, 113, 0.2);
            color: var(--success);
        }

        .icon-absent {
            background: rgba(231, 76, 60, 0.2);
            color: var(--danger);
        }

        .icon-wfh {
            background: rgba(52, 152, 219, 0.2);
            color: var(--secondary);
        }

        .icon-leave {
            background: rgba(155, 89, 182, 0.2);
            color: #9b59b6;
        }

        .card-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
            font-family: 'Poppins', sans-serif;
            color: var(--dark);
        }

        .card-footer {
            color: var(--gray);
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Attendance Controls */
        .attendance-controls {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
            border: 1px solid #e0e0e0;
        }

        .controls-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .controls-header h3 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 22px;
            color: var(--primary);
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border-radius: 50px;
            border: none;
            font-family: 'Roboto', sans-serif;
            font-weight: 500;
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            white-space: nowrap;
        }

        .btn-primary {
            background: var(--secondary);
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #27ae60;
            transform: translateY(-2px);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--secondary);
            color: var(--secondary);
        }

        .btn-outline:hover {
            background: var(--secondary);
            color: white;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        /* Employee Table */
        .employee-table-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--card-shadow);
            border: 1px solid #e0e0e0;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .table-header h3 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 22px;
            color: var(--primary);
        }

        .table-filters {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .filter-select {
            padding: 10px 15px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            background: white;
            font-family: 'Roboto', sans-serif;
            font-size: 14px;
            outline: none;
            transition: var(--transition);
        }

        .filter-select:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .table-wrapper {
            overflow-x: auto;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
            background: var(--white);
        }

        thead {
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
            font-size: 16px;
            white-space: nowrap;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
            font-size: 14px;
            vertical-align: middle;
        }

        tbody tr {
            transition: var(--transition);
        }

        tbody tr:hover {
            background: rgba(52, 152, 219, 0.05);
        }

        .employee-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .employee-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #e0e0e0;
        }

        .employee-details h4 {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 2px;
            font-size: 14px;
        }

        .employee-details span {
            color: var(--gray);
            font-size: 12px;
        }

        .status-badge {
            padding: 6px 15px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 500;
            display: inline-block;
        }

        .status-present {
            background: rgba(46, 204, 113, 0.15);
            color: var(--success);
        }

        .status-absent {
            background: rgba(231, 76, 60, 0.15);
            color: var(--danger);
        }

        .status-wfh {
            background: rgba(52, 152, 219, 0.15);
            color: var(--secondary);
        }

        .status-leave {
            background: rgba(155, 89, 182, 0.15);
            color: #9b59b6;
        }

        .leave-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            font-size: 12px;
            margin-top: 5px;
        }

        .leave-item {
            text-align: center;
            padding: 4px;
            border-radius: 4px;
            background: rgba(52, 152, 219, 0.1);
        }

        .leave-item.danger {
            background: rgba(231, 76, 60, 0.1);
            color: var(--danger);
        }

        .leave-item.warning {
            background: rgba(243, 156, 18, 0.1);
            color: var(--warning);
        }

        .reason-select {
            padding: 8px 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            background: white;
            font-family: 'Roboto', sans-serif;
            font-size: 14px;
            outline: none;
            cursor: pointer;
            transition: var(--transition);
            min-width: 150px;
        }

        .reason-select:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .action-cell {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .action-btn {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            cursor: pointer;
            transition: var(--transition);
            color: var(--dark);
            font-size: 14px;
        }

        .action-btn:hover {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }

        .action-btn.danger:hover {
            background: var(--danger);
            border-color: var(--danger);
        }

        /* History Styles */
        .history-date-group {
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }

        .history-date-header {
            background: #f8f9fa;
            padding: 15px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-date-title {
            font-weight: 600;
            color: var(--primary);
        }

        .history-stats {
            display: flex;
            gap: 15px;
            font-size: 12px;
        }

        .history-preview {
            padding: 15px 20px;
        }

        .history-employees {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .history-employee {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            background: white;
            padding: 8px 12px;
            border-radius: 20px;
            border: 1px solid #e0e0e0;
        }

        .history-employee img {
            width: 24px;
            height: 24px;
            border-radius: 50%;
        }

        .view-more-btn {
            background: var(--light);
            border: 1px solid #e0e0e0;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: var(--transition);
        }

        .view-more-btn:hover {
            background: var(--secondary);
            color: white;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            animation: modalOpen 0.3s ease;
            margin: 20px;
        }

        @keyframes modalOpen {
            from { opacity: 0; transform: scale(0.9) translateY(-20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .modal-header {
            padding: 25px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 20px;
            color: var(--dark);
        }

        .close-modal {
            background: #f8f9fa;
            border: none;
            color: var(--gray);
            font-size: 18px;
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .close-modal:hover {
            background: var(--danger);
            color: white;
        }

        .modal-body {
            padding: 25px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            padding: 12px 16px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            font-family: 'Roboto', sans-serif;
            font-size: 14px;
            transition: var(--transition);
            background: var(--white);
        }

        .form-control:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
            outline: none;
        }

        .modal-footer {
            padding: 25px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            background: #f8f9fa;
        }

        .auth-warning {
            background: rgba(243, 156, 18, 0.1);
            border: 1px solid var(--warning);
            color: #d68910;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
        }

        .toast {
            background: var(--white);
            border-radius: 10px;
            padding: 16px 20px;
            margin-bottom: 10px;
            box-shadow: var(--card-shadow);
            border-left: 4px solid var(--success);
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 300px;
            animation: toastSlideIn 0.3s ease;
        }

        .toast.error { border-left-color: var(--danger); }
        .toast.warning { border-left-color: var(--warning); }
        .toast.info { border-left-color: var(--secondary); }

        @keyframes toastSlideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .toast-message {
            flex: 1;
            color: var(--dark);
            font-weight: 500;
        }

        /* Reports Page */
        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .report-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            border: 1px solid #e0e0e0;
        }

        .report-card h4 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .report-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .metric {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            font-family: 'Poppins', sans-serif;
        }

        .metric-label {
            font-size: 12px;
            color: var(--gray);
            margin-top: 5px;
        }

        /* Settings Page */
        .settings-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--card-shadow);
            border: 1px solid #e0e0e0;
        }

        .settings-section h3 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--primary);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-info h4 {
            font-weight: 500;
            margin-bottom: 5px;
        }

        .setting-info p {
            font-size: 14px;
            color: var(--gray);
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
        }

        .toggle-switch.active {
            background: var(--success);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: var(--transition);
        }

        .toggle-switch.active::after {
            transform: translateX(26px);
        }

        /* Mobile Overlay */
        .mobile-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 99;
        }

        .mobile-menu-btn {
            display: none;
            background: var(--secondary);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .mobile-overlay.active {
                display: block;
            }

            .mobile-menu-btn {
                display: flex;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 15px;
            }

            .header {
                padding: 15px 20px;
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }

            .header-right {
                flex-direction: column;
                gap: 15px;
            }

            .search-container input {
                width: 100%;
            }

            .dashboard-cards {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .table-filters {
                flex-direction: column;
            }

            .filter-select {
                width: 100%;
            }

            .modal-content {
                margin: 10px;
                max-height: 95vh;
            }

            .modal-header,
            .modal-body,
            .modal-footer {
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .main-content {
                padding: 10px;
            }

            .card {
                padding: 20px;
            }

            .attendance-controls,
            .employee-table-container {
                padding: 20px;
            }

            th, td {
                padding: 12px 8px;
            }

            .employee-info {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
        }

        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid var(--secondary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Support page styles */
        .support-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--card-shadow);
            border: 1px solid #e0e0e0;
        }

        .support-card h4 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .faq-item {
            border-bottom: 1px solid #e0e0e0;
            padding: 15px 0;
        }

        .faq-item:last-child {
            border-bottom: none;
        }

        .faq-question {
            font-weight: 600;
            margin-bottom: 8px;
            cursor: pointer;
            color: var(--primary);
        }

        .faq-answer {
            color: var(--gray);
            font-size: 14px;
            display: none;
        }

        .faq-answer.active {
            display: block;
        }
    </style>
    <link rel="icon" type="image/png" sizes="32x32" href="https://cdn.prod.website-files.com/669a55be953bf5aa9e39fee0/669e152b15bd7c845bea53d5_favicon-32x32.png">
</head>
<body>
    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="logo-container">
                <div class="logo">
                    <img src="https://cdn.prod.website-files.com/669a55be953bf5aa9e39fee0/669a61c3903afa730c741a0d_Group%2037682.png" alt="AttendPro Logo">
                    <div>
                        <!-- <h1>AttendPro</h1>
                        <span>Sithafal Technologies</span> -->
                    </div>
                </div>
                <button class="sidebar-toggle" id="sidebarToggle">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>
            <div class="nav-menu">
                <div class="nav-item active" data-page="dashboard">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </div>
                <div class="nav-item" data-page="attendance">
                    <i class="fas fa-calendar-check"></i>
                    <span>Attendance</span>
                </div>
                <div class="nav-item" data-page="employees">
                    <i class="fas fa-users"></i>
                    <span>Employees</span>
                </div>
                <div class="nav-item" data-page="interns">
                    <i class="fas fa-user-graduate"></i>
                    <span>Interns</span>
                </div>
                <div class="nav-item" data-page="reports">
                    <i class="fas fa-chart-bar"></i>
                    <span>Reports</span>
                </div>
                <div class="nav-item" data-page="history">
                    <i class="fas fa-history"></i>
                    <span>History</span>
                </div>
                <div class="nav-item" data-page="settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </div>
                <div class="nav-item" data-page="support">
                    <i class="fas fa-question-circle"></i>
                    <span>Help & Support</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div>
                        <h2 id="headerTitle">Employee Attendance Dashboard</h2>
                        <div class="header-subtitle" id="attendanceDateDisplay">
                            Taking attendance for: <strong id="currentAttendanceDate"></strong>
                        </div>
                    </div>
                </div>
                <div class="header-right">
                    <div class="date-picker">
                        <i class="fas fa-calendar-alt"></i>
                        <input type="date" id="attendanceDate">
                    </div>
                    <div class="search-container">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search employee..." id="searchEmployee">
                    </div>
                    <div class="user-profile">
                        <img src="https://randomuser.me/api/portraits/women/65.jpg" alt="HR Manager">
                        <span>Jeevitha Kuncham</span>
                    </div>
                </div>
            </div>

            <!-- Dashboard Page -->
            <div class="page-content active" id="dashboardPage">
                <!-- Dashboard Cards -->
                <div class="dashboard-cards">
                    <div class="card">
                        <div class="card-header">
                            <h3>Total Employees</h3>
                            <div class="card-icon icon-present">
                                <i class="fas fa-users"></i>
                            </div>
                        </div>
                        <div class="card-value" id="totalEmployees">84</div>
                        <div class="card-footer">
                            <i class="fas fa-arrow-up"></i>
                            <span>5 new employees this month</span>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3>Present Today</h3>
                            <div class="card-icon icon-present">
                                <i class="fas fa-user-check"></i>
                            </div>
                        </div>
                        <div class="card-value" id="presentToday">76</div>
                        <div class="card-footer">
                            <i class="fas fa-check-circle"></i>
                            <span id="attendanceRate">90.5% attendance rate</span>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3>Working From Home</h3>
                            <div class="card-icon icon-wfh">
                                <i class="fas fa-laptop-house"></i>
                            </div>
                        </div>
                        <div class="card-value" id="wfhToday">5</div>
                        <div class="card-footer">
                            <i class="fas fa-home"></i>
                            <span>Hybrid work policy</span>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3>On Leave</h3>
                            <div class="card-icon icon-leave">
                                <i class="fas fa-umbrella-beach"></i>
                            </div>
                        </div>
                        <div class="card-value" id="onLeave">3</div>
                        <div class="card-footer">
                            <i class="fas fa-exclamation-circle"></i>
                            <span>2 sick leave, 1 casual leave</span>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3>Absent Today</h3>
                            <div class="card-icon icon-absent">
                                <i class="fas fa-user-times"></i>
                            </div>
                        </div>
                        <div class="card-value" id="absentToday">8</div>
                        <div class="card-footer">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Needs attention</span>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3>Total Interns</h3>
                            <div class="card-icon icon-wfh">
                                <i class="fas fa-user-graduate"></i>
                            </div>
                        </div>
                        <div class="card-value" id="totalInterns">12</div>
                        <div class="card-footer">
                            <i class="fas fa-arrow-up"></i>
                            <span>3 new interns this month</span>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="attendance-controls">
                    <div class="controls-header">
                        <h3>Quick Actions</h3>
                        <div class="action-buttons">
                            <button class="btn btn-outline" id="addEmployeeBtn">
                                <i class="fas fa-plus"></i>
                                Add Employee
                            </button>
                            <button class="btn btn-outline" id="addInternBtn">
                                <i class="fas fa-plus"></i>
                                Add Intern
                            </button>
                            <button class="btn btn-primary" id="markAbsentBtn">
                                <i class="fas fa-user-times"></i>
                                Mark Absent
                            </button>
                            <button class="btn btn-success" id="allPresentBtn">
                                <i class="fas fa-check-circle"></i>
                                Mark All Present
                            </button>
                        </div>
                    </div>
                    <p>Manage attendance and employee records from here.</p>
                </div>
            </div>

            <!-- Attendance Page -->
            <div class="page-content" id="attendancePage">
                <div class="attendance-controls">
                    <div class="controls-header">
                        <h3>Mark Attendance</h3>
                        <div class="action-buttons">
                            <button class="btn btn-primary" id="markAbsentBtn2">
                                <i class="fas fa-user-times"></i>
                                Mark Absent
                            </button>
                            <button class="btn btn-success" id="allPresentBtn2">
                                <i class="fas fa-check-circle"></i>
                                Mark All Present
                            </button>
                        </div>
                    </div>
                    <p>Select employees who are absent today and specify the reason. All other employees will be marked as present.</p>
                </div>

                <!-- Employee Table -->
                <div class="employee-table-container">
                    <div class="table-header">
                        <h3>Employee Attendance</h3>
                        <div class="table-filters">
                            <select class="filter-select" id="departmentFilter">
                                <option value="">All Departments</option>
                                <option value="Engineering">Engineering</option>
                                <option value="HR">Human Resources</option>
                                <option value="Marketing">Marketing</option>
                                <option value="Sales">Sales</option>
                                <option value="Design">Design</option>
                                <option value="Cyber Security">Cyber Security</option>
                            </select>
                            <select class="filter-select" id="statusFilter">
                                <option value="">All Status</option>
                                <option value="present">Present</option>
                                <option value="absent">Absent</option>
                                <option value="wfh">Work From Home</option>
                                <option value="leave">On Leave</option>
                            </select>
                            <button class="btn btn-outline" id="exportBtn">
                                <i class="fas fa-download"></i>
                                Export to Excel
                            </button>
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Employee</th>
                                    <th>ID</th>
                                    <th>Department</th>
                                    <th>Status</th>
                                    <th>Annual Leave Status</th>
                                    <th>Reason (if absent)</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="employeeTableBody">
                                <!-- Dynamic content will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Employees Page -->
            <div class="page-content" id="employeesPage">
                <div class="attendance-controls">
                    <div class="controls-header">
                        <h3>Employee Management</h3>
                        <div class="action-buttons">
                            <button class="btn btn-success" id="addEmployeeBtn2">
                                <i class="fas fa-plus"></i>
                                Add Employee
                            </button>
                            <button class="btn btn-outline" id="bulkImportBtn">
                                <i class="fas fa-upload"></i>
                                Bulk Import
                            </button>
                        </div>
                    </div>
                    <p>Manage all employee records and information.</p>
                </div>

                <div class="employee-table-container">
                    <div class="table-header">
                        <h3>All Employees</h3>
                        <div class="table-filters">
                            <select class="filter-select" id="departmentFilter2">
                                <option value="">All Departments</option>
                                <option value="Engineering">Engineering</option>
                                <option value="HR">Human Resources</option>
                                <option value="Marketing">Marketing</option>
                                <option value="Sales">Sales</option>
                                <option value="Design">Design</option>
                                <option value="Cyber Security">Cyber Security</option>
                            </select>
                            <button class="btn btn-outline" id="exportEmployeesBtn">
                                <i class="fas fa-download"></i>
                                Export List
                            </button>
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Employee</th>
                                    <th>ID</th>
                                    <th>Department</th>
                                    <th>Position</th>
                                    <th>Annual Attendance %</th>
                                    <th>Leave Balance</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="employeesTableBody">
                                <!-- Dynamic content will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Interns Page -->
            <div class="page-content" id="internsPage">
                <div class="attendance-controls">
                    <div class="controls-header">
                        <h3>Intern Management</h3>
                        <div class="action-buttons">
                            <button class="btn btn-success" id="addInternBtn2">
                                <i class="fas fa-plus"></i>
                                Add Intern
                            </button>
                        </div>
                    </div>
                    <p>Manage all intern records and track their progress.</p>
                </div>

                <div class="employee-table-container">
                    <div class="table-header">
                        <h3>All Interns</h3>
                        <div class="table-filters">
                            <select class="filter-select" id="departmentFilter3">
                                <option value="">All Departments</option>
                                <option value="Engineering">Engineering</option>
                                <option value="HR">Human Resources</option>
                                <option value="Marketing">Marketing</option>
                                <option value="Sales">Sales</option>
                                <option value="Design">Design</option>
                                <option value="Cyber Security">Cyber Security</option>
                            </select>
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Intern</th>
                                    <th>ID</th>
                                    <th>Department</th>
                                    <th>Duration</th>
                                    <th>Attendance %</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="internsTableBody">
                                <!-- Dynamic content will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Reports Page -->
            <div class="page-content" id="reportsPage">
                <div class="attendance-controls">
                    <div class="controls-header">
                        <h3>Attendance Reports</h3>
                        <div class="action-buttons">
                            <button class="btn btn-primary" id="generateReportBtn">
                                <i class="fas fa-chart-line"></i>
                                Generate Report
                            </button>
                            <button class="btn btn-outline" id="scheduleReportBtn">
                                <i class="fas fa-clock"></i>
                                Schedule Report
                            </button>
                        </div>
                    </div>
                    <p>Generate and analyze attendance reports and statistics.</p>
                </div>

                <div class="reports-grid">
                    <div class="report-card">
                        <h4><i class="fas fa-calendar-week"></i> Weekly Summary</h4>
                        <div class="report-metrics">
                            <div class="metric">
                                <div class="metric-value">94%</div>
                                <div class="metric-label">Average Attendance</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">7</div>
                                <div class="metric-label">Peak Absent Day</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">15</div>
                                <div class="metric-label">WFH Requests</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">3</div>
                                <div class="metric-label">Leave Applications</div>
                            </div>
                        </div>
                    </div>

                    <div class="report-card">
                        <h4><i class="fas fa-calendar-alt"></i> Monthly Overview</h4>
                        <div class="report-metrics">
                            <div class="metric">
                                <div class="metric-value">92%</div>
                                <div class="metric-label">Monthly Average</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">156</div>
                                <div class="metric-label">Total Leave Days</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">89</div>
                                <div class="metric-label">WFH Days</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">12</div>
                                <div class="metric-label">Overtime Days</div>
                            </div>
                        </div>
                    </div>

                    <div class="report-card">
                        <h4><i class="fas fa-chart-pie"></i> Department Wise</h4>
                        <div class="report-metrics">
                            <div class="metric">
                                <div class="metric-value">96%</div>
                                <div class="metric-label">Engineering</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">98%</div>
                                <div class="metric-label">HR</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">91%</div>
                                <div class="metric-label">Marketing</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">88%</div>
                                <div class="metric-label">Sales</div>
                            </div>
                        </div>
                    </div>

                    <div class="report-card">
                        <h4><i class="fas fa-exclamation-triangle"></i> Alerts & Notifications</h4>
                        <div class="report-metrics">
                            <div class="metric">
                                <div class="metric-value">5</div>
                                <div class="metric-label">Consecutive Absences</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">12</div>
                                <div class="metric-label">Leave Balance Low</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">3</div>
                                <div class="metric-label">Attendance Below 80%</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value">8</div>
                                <div class="metric-label">Pending Approvals</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- History Page -->
            <div class="page-content" id="historyPage">
                <div class="attendance-controls">
                    <div class="controls-header">
                        <h3>Attendance History</h3>
                        <div class="action-buttons">
                            <div class="date-range" style="display: flex; gap: 10px; align-items: center;">
                                <label>From:</label>
                                <input type="date" id="fromDate" class="form-control" style="width: auto;">
                                <label>To:</label>
                                <input type="date" id="toDate" class="form-control" style="width: auto;">
                            </div>
                            <button class="btn btn-primary" id="loadHistoryBtn">
                                <i class="fas fa-search"></i>
                                Load History
                            </button>
                            <button class="btn btn-outline" id="exportHistoryBtn">
                                <i class="fas fa-download"></i>
                                Export
                            </button>
                        </div>
                    </div>
                    <p>View and analyze attendance data for any date range.</p>
                </div>

                <div id="historyContainer">
                    <!-- History content will be dynamically generated here -->
                </div>
            </div>

            <!-- Settings Page -->
            <div class="page-content" id="settingsPage">
                <div class="settings-section">
                    <h3>General Settings</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Auto Mark Present</h4>
                            <p>Automatically mark employees as present if not marked absent by end of day</p>
                        </div>
                        <div class="toggle-switch active" data-setting="autoMarkPresent"></div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Email Notifications</h4>
                            <p>Send daily attendance summary via email</p>
                        </div>
                        <div class="toggle-switch active" data-setting="emailNotifications"></div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Require Authentication for Absence</h4>
                            <p>Require password confirmation when marking employees absent</p>
                        </div>
                        <div class="toggle-switch active" data-setting="requireAuth"></div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Leave Management</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Annual Sick Leave</h4>
                            <p>Number of paid sick leave days per year</p>
                        </div>
                        <input type="number" class="form-control" style="width: 80px;" value="14" id="sickLeaveLimit">
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Annual Casual Leave</h4>
                            <p>Number of paid casual leave days per year</p>
                        </div>
                        <input type="number" class="form-control" style="width: 80px;" value="14" id="casualLeaveLimit">
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Annual WFH Days</h4>
                            <p>Number of work from home days per year</p>
                        </div>
                        <input type="number" class="form-control" style="width: 80px;" value="14" id="wfhLimit">
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Security</h3>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Change Admin Password</h4>
                            <p>Update the admin password for sensitive operations</p>
                        </div>
                        <button class="btn btn-outline" id="changePasswordBtn">Change Password</button>
                    </div>
                    <div class="setting-item">
                        <div class="setting-info">
                            <h4>Session Timeout</h4>
                            <p>Auto-logout after specified minutes of inactivity</p>
                        </div>
                        <select class="form-control" style="width: 120px;">
                            <option value="15">15 minutes</option>
                            <option value="30" selected>30 minutes</option>
                            <option value="60">1 hour</option>
                            <option value="120">2 hours</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Support Page -->
            <div class="page-content" id="supportPage">
                <div class="support-card">
                    <h4><i class="fas fa-question-circle"></i> Frequently Asked Questions</h4>
                    <div class="faq-item">
                        <div class="faq-question">How do I mark an employee absent?</div>
                        <div class="faq-answer">Click on "Mark Absent" button, select the employee, choose a reason, and confirm. You'll need to enter the admin password for security.</div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">Can I edit attendance after it's marked?</div>
                        <div class="faq-answer">Yes, you can use the edit button next to each employee to modify their attendance status and reason.</div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">How are annual leave balances calculated?</div>
                        <div class="faq-answer">Each employee gets 14 days each of Sick Leave, Casual Leave, and WFH days annually. These reset every year.</div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">How can I export attendance data?</div>
                        <div class="faq-answer">Use the "Export" button in any attendance view to download data as CSV or Excel format.</div>
                    </div>
                </div>

                <div class="support-card">
                    <h4><i class="fas fa-phone"></i> Contact Support</h4>
                    <p>Need help? Contact our support team:</p>
                    <div style="margin-top: 15px;">
                        <p><strong>Email:</strong> support@sithafal.com</p>
                        <p><strong>Phone:</strong> +91 9876543210</p>
                        <p><strong>Hours:</strong> Monday - Friday, 9:00 AM - 6:00 PM IST</p>
                    </div>
                </div>

                <div class="support-card">
                    <h4><i class="fas fa-book"></i> User Manual</h4>
                    <p>Download the complete user manual for detailed instructions:</p>
                    <div style="margin-top: 15px;">
                        <button class="btn btn-primary">
                            <i class="fas fa-download"></i>
                            Download User Manual
                        </button>
                    </div>
                </div>

                <div class="support-card">
                    <h4><i class="fas fa-info-circle"></i> System Information</h4>
                    <div style="margin-top: 15px;">
                        <p><strong>Version:</strong> AttendPro v2.1.0</p>
                        <p><strong>Last Updated:</strong> January 2025</p>
                        <p><strong>Database:</strong> Connected</p>
                        <p><strong>Backup Status:</strong> Last backup: Today 3:00 AM</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Authentication Modal for Absent Marking -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Authentication Required</h3>
                <button class="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="auth-warning">
                    <i class="fas fa-shield-alt"></i>
                    <span>Admin password required to mark employees absent for security purposes.</span>
                </div>
                <div class="form-group">
                    <label class="form-label" for="adminPassword">Admin Password</label>
                    <input type="password" class="form-control" id="adminPassword" placeholder="Enter admin password">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline close-modal">Cancel</button>
                <button class="btn btn-primary" id="authenticateBtn">Authenticate</button>
            </div>
        </div>
    </div>

    <!-- Mark Absent Modal -->
    <div class="modal" id="absentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Mark Employee Absent</h3>
                <button class="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="employeeSelect">Select Employee</label>
                    <select class="form-control" id="employeeSelect">
                        <option value="">Select an employee</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="reasonSelect">Absence Reason</label>
                    <select class="form-control" id="reasonSelect">
                        <option value="">Select reason</option>
                        <option value="Work From Home">Work From Home</option>
                        <option value="Sick Leave">Sick Leave</option>
                        <option value="Casual Leave">Casual Leave</option>
                        <option value="Emergency Leave">Emergency Leave</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group" id="otherReasonContainer" style="display:none;">
                    <label class="form-label" for="otherReason">Specify Reason</label>
                    <input type="text" class="form-control" id="otherReason" placeholder="Enter reason for absence">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline close-modal">Cancel</button>
                <button class="btn btn-primary" id="saveAbsenceBtn">Save</button>
            </div>
        </div>
    </div>

    <!-- Edit Employee Modal -->
    <div class="modal" id="editEmployeeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Edit Employee</h3>
                <button class="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="editEmpName">Full Name</label>
                    <input type="text" class="form-control" id="editEmpName" placeholder="Enter full name">
                </div>
                <div class="form-group">
                    <label class="form-label" for="editEmpDepartment">Department</label>
                    <select class="form-control" id="editEmpDepartment">
                        <option value="">Select department</option>
                        <option value="Engineering">Engineering</option>
                        <option value="HR">Human Resources</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Sales">Sales</option>
                        <option value="Design">Design</option>
                        <option value="Cyber Security">Cyber Security</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="editEmpPosition">Position</label>
                    <input type="text" class="form-control" id="editEmpPosition" placeholder="Enter position">
                </div>
                <div class="form-group">
                    <label class="form-label" for="editEmpJoinDate">Join Date</label>
                    <input type="date" class="form-control" id="editEmpJoinDate">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline close-modal">Cancel</button>
                <button class="btn btn-success" id="updateEmployeeBtn">Update Employee</button>
            </div>
        </div>
    </div>

    <!-- Add Employee Modal -->
    <div class="modal" id="addEmployeeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Employee</h3>
                <button class="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="empName">Full Name</label>
                    <input type="text" class="form-control" id="empName" placeholder="Enter full name">
                </div>
                <div class="form-group">
                    <label class="form-label" for="empDepartment">Department</label>
                    <select class="form-control" id="empDepartment">
                        <option value="">Select department</option>
                        <option value="Engineering">Engineering</option>
                        <option value="HR">Human Resources</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Sales">Sales</option>
                        <option value="Design">Design</option>
                        <option value="Cyber Security">Cyber Security</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="empPosition">Position</label>
                    <input type="text" class="form-control" id="empPosition" placeholder="Enter position">
                </div>
                <div class="form-group">
                    <label class="form-label" for="empJoinDate">Join Date</label>
                    <input type="date" class="form-control" id="empJoinDate">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline close-modal">Cancel</button>
                <button class="btn btn-success" id="saveEmployeeBtn">Save Employee</button>
            </div>
        </div>
    </div>

    <!-- Add Intern Modal -->
    <div class="modal" id="addInternModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Intern</h3>
                <button class="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="internName">Full Name</label>
                    <input type="text" class="form-control" id="internName" placeholder="Enter full name">
                </div>
                <div class="form-group">
                    <label class="form-label" for="internDepartment">Department</label>
                    <select class="form-control" id="internDepartment">
                        <option value="">Select department</option>
                        <option value="Engineering">Engineering</option>
                        <option value="HR">Human Resources</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Sales">Sales</option>
                        <option value="Design">Design</option>
                        <option value="Cyber Security">Cyber Security</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="internDuration">Duration (months)</label>
                    <select class="form-control" id="internDuration">
                        <option value="">Select duration</option>
                        <option value="1">1 Month</option>
                        <option value="2">2 Months</option>
                        <option value="3">3 Months</option>
                        <option value="6">6 Months</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="internStartDate">Start Date</label>
                    <input type="date" class="form-control" id="internStartDate">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline close-modal">Cancel</button>
                <button class="btn btn-success" id="saveInternBtn">Save Intern</button>
            </div>
        </div>
    </div>

    <script>
        // Application Data
        let employees = [
            {
                id: 'EMP001',
                name: 'Leela Srinivas Atla',
                department: 'Cyber Security',
                position: 'Cyber Security Analyst',
                avatar: 'https://randomuser.me/api/portraits/men/1.jpg',
                type: 'employee',
                joinDate: '2023-01-15',
                annualLeaves: {
                    sickLeave: { used: 3, total: 14 },
                    casualLeave: { used: 5, total: 14 },
                    wfh: { used: 8, total: 14 }
                }
            },
            {
                id: 'EMP002',
                name: 'Yashwanth Kadiri',
                department: 'Cyber Security',
                position: 'Cyber Security Analyst',
                avatar: 'https://randomuser.me/api/portraits/men/2.jpg',
                type: 'employee',
                joinDate: '2023-02-10',
                annualLeaves: {
                    sickLeave: { used: 2, total: 14 },
                    casualLeave: { used: 4, total: 14 },
                    wfh: { used: 6, total: 14 }
                }
            },
            {
                id: 'EMP003',
                name: 'Pavan Shankar',
                department: 'Engineering',
                position: 'Software Developer',
                avatar: 'https://randomuser.me/api/portraits/men/3.jpg',
                type: 'employee',
                joinDate: '2022-11-20',
                annualLeaves: {
                    sickLeave: { used: 1, total: 14 },
                    casualLeave: { used: 7, total: 14 },
                    wfh: { used: 12, total: 14 }
                }
            },
            {
                id: 'EMP004',
                name: 'Sarah Williams',
                department: 'HR',
                position: 'HR Specialist',
                avatar: 'https://randomuser.me/api/portraits/women/1.jpg',
                type: 'employee',
                joinDate: '2023-03-05',
                annualLeaves: {
                    sickLeave: { used: 4, total: 14 },
                    casualLeave: { used: 3, total: 14 },
                    wfh: { used: 5, total: 14 }
                }
            },
            {
                id: 'EMP005',
                name: 'David Brown',
                department: 'Engineering',
                position: 'Senior Developer',
                avatar: 'https://randomuser.me/api/portraits/men/4.jpg',
                type: 'employee',
                joinDate: '2022-08-15',
                annualLeaves: {
                    sickLeave: { used: 6, total: 14 },
                    casualLeave: { used: 8, total: 14 },
                    wfh: { used: 10, total: 14 }
                }
            },
            {
                id: 'INT001',
                name: 'Priya Sharma',
                department: 'Engineering',
                position: 'Software Development Intern',
                avatar: 'https://randomuser.me/api/portraits/women/2.jpg',
                type: 'intern',
                startDate: '2024-12-01',
                duration: 3,
                annualLeaves: {
                    sickLeave: { used: 1, total: 14 },
                    casualLeave: { used: 2, total: 14 },
                    wfh: { used: 3, total: 14 }
                }
            },
            {
                id: 'INT002',
                name: 'Rahul Verma',
                department: 'Marketing',
                position: 'Marketing Intern',
                avatar: 'https://randomuser.me/api/portraits/men/5.jpg',
                type: 'intern',
                startDate: '2024-11-15',
                duration: 6,
                annualLeaves: {
                    sickLeave: { used: 0, total: 14 },
                    casualLeave: { used: 1, total: 14 },
                    wfh: { used: 2, total: 14 }
                }
            }
        ];

        // Application Settings
        let appSettings = {
            adminPassword: 'admin123',
            autoMarkPresent: true,
            emailNotifications: true,
            requireAuth: true,
            sickLeaveLimit: 14,
            casualLeaveLimit: 14,
            wfhLimit: 14
        };

        // Attendance Data - stored by date
        let attendanceData = {};
        let currentDate = '';
        let currentView = 'dashboard';
        let editingEmployeeId = null;

        // Get today's date and max allowed date (today + 2 days)
        function getDateLimits() {
            const today = new Date();
            const maxDate = new Date(today.getTime() + 2 * 24 * 60 * 60 * 1000);
            return {
                today: today.toISOString().split('T')[0],
                maxDate: maxDate.toISOString().split('T')[0]
            };
        }

        // Initialize attendance for today
        function initializeTodayAttendance() {
            const { today, maxDate } = getDateLimits();
            currentDate = today;
            
            // Set date picker limits
            const dateInput = document.getElementById('attendanceDate');
            dateInput.max = maxDate;
            
            if (!attendanceData[today]) {
                attendanceData[today] = {};
                employees.forEach(emp => {
                    // Default to present for demo, in reality would be unmarked
                    const status = Math.random() > 0.2 ? 'present' : (Math.random() > 0.5 ? 'absent' : 'wfh');
                    attendanceData[today][emp.id] = {
                        status: status,
                        reason: status === 'absent' ? 'Sick Leave' : (status === 'wfh' ? 'Remote work day' : ''),
                        timestamp: new Date().toISOString()
                    };
                });
            }
            
            updateCurrentDateDisplay();
            updateDashboardStats();
            renderEmployeeTable();
        }

        // Update current date display
        function updateCurrentDateDisplay() {
            const dateObj = new Date(currentDate);
            const formattedDate = dateObj.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('currentAttendanceDate').textContent = formattedDate;
            document.getElementById('attendanceDate').value = currentDate;
        }

        // Update dashboard statistics
        function updateDashboardStats() {
            const todayData = attendanceData[currentDate] || {};
            const regularEmployees = employees.filter(emp => emp.type === 'employee');
            const interns = employees.filter(emp => emp.type === 'intern');
            
            let present = 0, absent = 0, wfh = 0, leave = 0;
            
            employees.forEach(emp => {
                const attendance = todayData[emp.id];
                if (attendance) {
                    switch (attendance.status) {
                        case 'present': present++; break;
                        case 'absent': absent++; break;
                        case 'wfh': wfh++; break;
                        case 'leave': leave++; break;
                    }
                }
            });
            
            document.getElementById('totalEmployees').textContent = regularEmployees.length;
            document.getElementById('totalInterns').textContent = interns.length;
            document.getElementById('presentToday').textContent = present;
            document.getElementById('absentToday').textContent = absent;
            document.getElementById('wfhToday').textContent = wfh;
            document.getElementById('onLeave').textContent = leave;
            
            const total = present + wfh + absent + leave;
            const rate = total > 0 ? Math.round(((present + wfh) / total) * 100) : 0;
            document.getElementById('attendanceRate').textContent = `${rate}% attendance rate`;
        }

        // Calculate annual attendance percentage
        function calculateAnnualAttendance(empId) {
            const currentYear = new Date().getFullYear();
            let totalDays = 0;
            let presentDays = 0;

            Object.keys(attendanceData).forEach(date => {
                if (new Date(date).getFullYear() === currentYear) {
                    totalDays++;
                    const attendance = attendanceData[date][empId];
                    if (attendance && (attendance.status === 'present' || attendance.status === 'wfh')) {
                        presentDays++;
                    }
                }
            });

            return totalDays > 0 ? Math.round((presentDays / totalDays) * 100) : 100;
        }

        // Render employee table based on current view
        function renderEmployeeTable() {
            const tbody = document.getElementById('employeeTableBody');
            const todayData = attendanceData[currentDate] || {};
            let filteredEmployees = employees;

            // Filter based on current view
            if (currentView === 'employees') {
                filteredEmployees = employees.filter(emp => emp.type === 'employee');
                renderEmployeesTable();
                return;
            } else if (currentView === 'interns') {
                filteredEmployees = employees.filter(emp => emp.type === 'intern');
                renderInternsTable();
                return;
            }

            // Apply filters for attendance view
            const departmentFilter = document.getElementById('departmentFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const searchTerm = document.getElementById('searchEmployee').value.toLowerCase();
            
            if (departmentFilter) {
                filteredEmployees = filteredEmployees.filter(emp => emp.department === departmentFilter);
            }
            
            if (searchTerm) {
                filteredEmployees = filteredEmployees.filter(emp =>
                    emp.name.toLowerCase().includes(searchTerm) ||
                    emp.id.toLowerCase().includes(searchTerm) ||
                    emp.department.toLowerCase().includes(searchTerm)
                );
            }
            
            if (statusFilter) {
                filteredEmployees = filteredEmployees.filter(emp => {
                    const attendance = todayData[emp.id];
                    return attendance && attendance.status === statusFilter;
                });
            }
            
            tbody.innerHTML = filteredEmployees.map(emp => {
                const attendance = todayData[emp.id] || { status: 'present', reason: '' };
                const statusClass = `status-${attendance.status}`;
                const statusText = attendance.status.charAt(0).toUpperCase() + attendance.status.slice(1);
                const leaves = emp.annualLeaves || { sickLeave: { used: 0, total: 14 }, casualLeave: { used: 0, total: 14 }, wfh: { used: 0, total: 14 }};
                
                return `
                    <tr>
                        <td>
                            <div class="employee-info">
                                <img src="${emp.avatar}" alt="${emp.name}" class="employee-avatar">
                                <div class="employee-details">
                                    <h4>${emp.name}</h4>
                                    <span>${emp.position}</span>
                                </div>
                            </div>
                        </td>
                        <td><strong>${emp.id}</strong></td>
                        <td>${emp.department}</td>
                        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                        <td>
                            <div class="leave-info">
                                <div class="leave-item ${leaves.sickLeave.used > 10 ? 'danger' : (leaves.sickLeave.used > 7 ? 'warning' : '')}">
                                    SL: ${leaves.sickLeave.used}/${leaves.sickLeave.total}
                                </div>
                                <div class="leave-item ${leaves.casualLeave.used > 10 ? 'danger' : (leaves.casualLeave.used > 7 ? 'warning' : '')}">
                                    CL: ${leaves.casualLeave.used}/${leaves.casualLeave.total}
                                </div>
                                <div class="leave-item ${leaves.wfh.used > 10 ? 'danger' : (leaves.wfh.used > 7 ? 'warning' : '')}">
                                    WFH: ${leaves.wfh.used}/${leaves.wfh.total}
                                </div>
                            </div>
                        </td>
                        <td>
                            ${attendance.status === 'present' ? '-' : 
                              `<input type="text" class="reason-select" value="${attendance.reason}" 
                                     onchange="updateReason('${emp.id}', this.value)">`}
                        </td>
                        <td>
                            <div class="action-cell">
                                <button class="action-btn" onclick="editEmployee('${emp.id}')" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn" onclick="toggleStatus('${emp.id}')" title="Change Status">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                                <button class="action-btn danger" onclick="deleteEmployee('${emp.id}')" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Render employees table for employees page
        function renderEmployeesTable() {
            const tbody = document.getElementById('employeesTableBody');
            const regularEmployees = employees.filter(emp => emp.type === 'employee');
            const departmentFilter = document.getElementById('departmentFilter2') ? document.getElementById('departmentFilter2').value : '';
            
            let filteredEmployees = regularEmployees;
            if (departmentFilter) {
                filteredEmployees = filteredEmployees.filter(emp => emp.department === departmentFilter);
            }

            tbody.innerHTML = filteredEmployees.map(emp => {
                const attendancePercent = calculateAnnualAttendance(emp.id);
                const leaves = emp.annualLeaves || { sickLeave: { used: 0, total: 14 }, casualLeave: { used: 0, total: 14 }, wfh: { used: 0, total: 14 }};
                
                return `
                    <tr>
                        <td>
                            <div class="employee-info">
                                <img src="${emp.avatar}" alt="${emp.name}" class="employee-avatar">
                                <div class="employee-details">
                                    <h4>${emp.name}</h4>
                                    <span>${emp.position}</span>
                                </div>
                            </div>
                        </td>
                        <td><strong>${emp.id}</strong></td>
                        <td>${emp.department}</td>
                        <td>${emp.position}</td>
                        <td>
                            <strong style="color: ${attendancePercent >= 90 ? 'var(--success)' : (attendancePercent >= 80 ? 'var(--warning)' : 'var(--danger)')}">${attendancePercent}%</strong>
                        </td>
                        <td>
                            <div class="leave-info">
                                <div class="leave-item ${leaves.sickLeave.used > 10 ? 'danger' : (leaves.sickLeave.used > 7 ? 'warning' : '')}">
                                    SL: ${leaves.sickLeave.total - leaves.sickLeave.used} left
                                </div>
                                <div class="leave-item ${leaves.casualLeave.used > 10 ? 'danger' : (leaves.casualLeave.used > 7 ? 'warning' : '')}">
                                    CL: ${leaves.casualLeave.total - leaves.casualLeave.used} left
                                </div>
                                <div class="leave-item ${leaves.wfh.used > 10 ? 'danger' : (leaves.wfh.used > 7 ? 'warning' : '')}">
                                    WFH: ${leaves.wfh.total - leaves.wfh.used} left
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="action-cell">
                                <button class="action-btn" onclick="editEmployee('${emp.id}')" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn danger" onclick="deleteEmployee('${emp.id}')" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Render interns table for interns page
        function renderInternsTable() {
            const tbody = document.getElementById('internsTableBody');
            const interns = employees.filter(emp => emp.type === 'intern');
            const departmentFilter = document.getElementById('departmentFilter3') ? document.getElementById('departmentFilter3').value : '';
            
            let filteredInterns = interns;
            if (departmentFilter) {
                filteredInterns = filteredInterns.filter(emp => emp.department === departmentFilter);
            }

            tbody.innerHTML = filteredInterns.map(emp => {
                const attendancePercent = calculateAnnualAttendance(emp.id);
                const startDate = new Date(emp.startDate);
                const now = new Date();
                const monthsCompleted = Math.floor((now - startDate) / (1000 * 60 * 60 * 24 * 30));
                const status = monthsCompleted >= emp.duration ? 'Completed' : 'Active';
                
                return `
                    <tr>
                        <td>
                            <div class="employee-info">
                                <img src="${emp.avatar}" alt="${emp.name}" class="employee-avatar">
                                <div class="employee-details">
                                    <h4>${emp.name}</h4>
                                    <span>${emp.position}</span>
                                </div>
                            </div>
                        </td>
                        <td><strong>${emp.id}</strong></td>
                        <td>${emp.department}</td>
                        <td>${emp.duration} months</td>
                        <td>
                            <strong style="color: ${attendancePercent >= 90 ? 'var(--success)' : (attendancePercent >= 80 ? 'var(--warning)' : 'var(--danger)')}">${attendancePercent}%</strong>
                        </td>
                        <td>
                            <span class="status-badge ${status === 'Active' ? 'status-present' : 'status-leave'}">${status}</span>
                        </td>
                        <td>
                            <div class="action-cell">
                                <button class="action-btn" onclick="editEmployee('${emp.id}')" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn danger" onclick="deleteEmployee('${emp.id}')" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Page navigation
        function switchPage(page) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
            
            // Show selected page
            document.getElementById(page + 'Page').classList.add('active');
            
            // Update header title
            const titles = {
                dashboard: 'Employee Attendance Dashboard',
                attendance: 'Mark Daily Attendance', 
                employees: 'Employee Management',
                interns: 'Intern Management',
                reports: 'Attendance Reports & Analytics',
                history: 'Attendance History',
                settings: 'System Settings',
                support: 'Help & Support'
            };
            
            document.getElementById('headerTitle').textContent = titles[page];
            
            // Hide/show stats cards based on page
            const statsCards = document.querySelector('.dashboard-cards');
            if (page === 'dashboard') {
                statsCards.style.display = 'grid';
            } else {
                statsCards.style.display = 'none';
            }
            
            currentView = page;
            
            // Render appropriate table
            if (page === 'attendance' || page === 'dashboard') {
                renderEmployeeTable();
            } else if (page === 'employees') {
                renderEmployeesTable();
            } else if (page === 'interns') {
                renderInternsTable();
            } else if (page === 'history') {
                setupHistoryView();
            }
        }

        // Authentication for sensitive operations
        function requireAuthentication(callback) {
            if (!appSettings.requireAuth) {
                callback();
                return;
            }
            
            document.getElementById('authModal').classList.add('active');
            document.getElementById('adminPassword').value = '';
            
            // Store callback for after authentication
            window.pendingAuthCallback = callback;
        }

        // Handle authentication
        function handleAuthentication() {
            const password = document.getElementById('adminPassword').value;
            
            if (password === appSettings.adminPassword) {
                document.getElementById('authModal').classList.remove('active');
                if (window.pendingAuthCallback) {
                    window.pendingAuthCallback();
                    window.pendingAuthCallback = null;
                }
                showToast('Authentication successful', 'success');
            } else {
                showToast('Invalid password', 'error');
            }
        }

        // Update reason
        function updateReason(empId, reason) {
            if (!attendanceData[currentDate]) {
                attendanceData[currentDate] = {};
            }
            if (!attendanceData[currentDate][empId]) {
                attendanceData[currentDate][empId] = { status: 'absent', reason: '', timestamp: new Date().toISOString() };
            }
            attendanceData[currentDate][empId].reason = reason;
            
            // Update leave usage if needed
            const emp = employees.find(e => e.id === empId);
            if (emp && reason && attendanceData[currentDate][empId].status !== 'present') {
                updateLeaveUsage(empId, reason);
            }
            
            saveData();
        }

        // Update leave usage
        function updateLeaveUsage(empId, reason) {
            const emp = employees.find(e => e.id === empId);
            if (!emp || !emp.annualLeaves) return;
            
            if (reason.toLowerCase().includes('sick')) {
                if (emp.annualLeaves.sickLeave.used < emp.annualLeaves.sickLeave.total) {
                    emp.annualLeaves.sickLeave.used++;
                }
            } else if (reason.toLowerCase().includes('casual')) {
                if (emp.annualLeaves.casualLeave.used < emp.annualLeaves.casualLeave.total) {
                    emp.annualLeaves.casualLeave.used++;
                }
            } else if (reason.toLowerCase().includes('wfh') || reason.toLowerCase().includes('home')) {
                if (emp.annualLeaves.wfh.used < emp.annualLeaves.wfh.total) {
                    emp.annualLeaves.wfh.used++;
                }
            }
        }

        // Toggle employee status
        function toggleStatus(empId) {
            requireAuthentication(() => {
                if (!attendanceData[currentDate]) {
                    attendanceData[currentDate] = {};
                }
                
                const current = attendanceData[currentDate][empId] || { status: 'present' };
                const statuses = ['present', 'absent', 'wfh', 'leave'];
                const currentIndex = statuses.indexOf(current.status);
                const nextStatus = statuses[(currentIndex + 1) % statuses.length];
                
                attendanceData[currentDate][empId] = {
                    status: nextStatus,
                    reason: nextStatus === 'present' ? '' : current.reason,
                    timestamp: new Date().toISOString()
                };
                
                updateDashboardStats();
                renderEmployeeTable();
                saveData();
                showToast(`Status updated to ${nextStatus}`, 'success');
            });
        }

        // Edit employee
        function editEmployee(empId) {
            const emp = employees.find(e => e.id === empId);
            if (emp) {
                editingEmployeeId = empId;
                document.getElementById('editEmpName').value = emp.name;
                document.getElementById('editEmpDepartment').value = emp.department;
                document.getElementById('editEmpPosition').value = emp.position;
                document.getElementById('editEmpJoinDate').value = emp.joinDate || emp.startDate || '';
                document.getElementById('editEmployeeModal').classList.add('active');
            }
        }

        // Update employee
        function updateEmployee() {
            if (!editingEmployeeId) return;
            
            const emp = employees.find(e => e.id === editingEmployeeId);
            if (!emp) return;
            
            const name = document.getElementById('editEmpName').value.trim();
            const department = document.getElementById('editEmpDepartment').value;
            const position = document.getElementById('editEmpPosition').value.trim();
            const date = document.getElementById('editEmpJoinDate').value;
            
            if (!name || !department || !position) {
                showToast('Please fill all required fields', 'error');
                return;
            }
            
            emp.name = name;
            emp.department = department;
            emp.position = position;
            if (emp.type === 'employee') {
                emp.joinDate = date;
            } else {
                emp.startDate = date;
            }
            
            renderEmployeeTable();
            saveData();
            
            document.getElementById('editEmployeeModal').classList.remove('active');
            editingEmployeeId = null;
            showToast(`${name} updated successfully!`, 'success');
        }

        // Delete employee
        function deleteEmployee(empId) {
            const emp = employees.find(e => e.id === empId);
            if (emp && confirm(`Are you sure you want to delete ${emp.name}?`)) {
                requireAuthentication(() => {
                    employees = employees.filter(e => e.id !== empId);
                    
                    // Remove from all attendance records
                    Object.keys(attendanceData).forEach(date => {
                        delete attendanceData[date][empId];
                    });
                    
                    updateDashboardStats();
                    renderEmployeeTable();
                    saveData();
                    showToast(`${emp.name} has been deleted`, 'success');
                });
            }
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            toast.innerHTML = `
                <div class="toast-message">${message}</div>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 4000);
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('attendPro_employees', JSON.stringify(employees));
            localStorage.setItem('attendPro_attendance', JSON.stringify(attendanceData));
            localStorage.setItem('attendPro_settings', JSON.stringify(appSettings));
        }

        // Load data from localStorage
        function loadData() {
            const savedEmployees = localStorage.getItem('attendPro_employees');
            const savedAttendance = localStorage.getItem('attendPro_attendance');
            const savedSettings = localStorage.getItem('attendPro_settings');
            
            if (savedEmployees) {
                employees = JSON.parse(savedEmployees);
            }
            
            if (savedAttendance) {
                attendanceData = JSON.parse(savedAttendance);
            }
            
            if (savedSettings) {
                appSettings = { ...appSettings, ...JSON.parse(savedSettings) };
            }
        }

        // Generate unique ID
        function generateId(prefix) {
            const timestamp = Date.now().toString().slice(-6);
            const random = Math.floor(Math.random() * 100).toString().padStart(2, '0');
            return `${prefix}${timestamp}${random}`;
        }

        // Setup history view
        function setupHistoryView() {
            const today = new Date();
            const oneWeekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
            
            document.getElementById('fromDate').value = oneWeekAgo.toISOString().split('T')[0];
            document.getElementById('toDate').value = today.toISOString().split('T')[0];
            
            loadHistory();
        }

        // Load history data
        function loadHistory() {
            const fromDate = document.getElementById('fromDate').value;
            const toDate = document.getElementById('toDate').value;
            
            if (!fromDate || !toDate) {
                showToast('Please select date range', 'error');
                return;
            }
            
            const container = document.getElementById('historyContainer');
            let historyHtml = '';
            
            const startDate = new Date(fromDate);
            const endDate = new Date(toDate);
            
            for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
                const dateStr = d.toISOString().split('T')[0];
                const dayData = attendanceData[dateStr] || {};
                
                let present = 0, absent = 0, wfh = 0;
                employees.forEach(emp => {
                    const attendance = dayData[emp.id] || { status: 'present' };
                    if (attendance.status === 'present') present++;
                    else if (attendance.status === 'absent') absent++;
                    else if (attendance.status === 'wfh') wfh++;
                });
                
                // Show only first 3 employees
                const previewEmployees = employees.slice(0, 3);
                const remainingCount = Math.max(0, employees.length - 3);
                
                historyHtml += `
                    <div class="history-date-group">
                        <div class="history-date-header">
                            <div class="history-date-title">${d.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>
                            <div class="history-stats">
                                <span style="color: var(--success);">Present: ${present}</span>
                                <span style="color: var(--danger);">Absent: ${absent}</span>
                                <span style="color: var(--secondary);">WFH: ${wfh}</span>
                            </div>
                        </div>
                        <div class="history-preview">
                            <div class="history-employees">
                                ${previewEmployees.map(emp => {
                                    const attendance = dayData[emp.id] || { status: 'present' };
                                    const statusClass = `status-${attendance.status}`;
                                    return `
                                        <div class="history-employee">
                                            <img src="${emp.avatar}" alt="${emp.name}">
                                            <span>${emp.name}</span>
                                            <span class="status-badge ${statusClass}">${attendance.status}</span>
                                        </div>
                                    `;
                                }).join('')}
                                ${remainingCount > 0 ? `
                                    <button class="view-more-btn" onclick="expandHistoryDate('${dateStr}')">
                                        +${remainingCount} more
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = historyHtml;
            showToast('History loaded successfully!', 'success');
        }

        // Expand history date to show all employees
        function expandHistoryDate(dateStr) {
            const dayData = attendanceData[dateStr] || {};
            
            // Create a modal or expanded view
            const modalHtml = `
                <div class="modal active" id="historyDetailModal">
                    <div class="modal-content" style="max-width: 800px;">
                        <div class="modal-header">
                            <h3 class="modal-title">Attendance for ${new Date(dateStr).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</h3>
                            <button class="close-modal" onclick="closeHistoryDetail()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="table-wrapper">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Employee</th>
                                            <th>Department</th>
                                            <th>Status</th>
                                            <th>Reason</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${employees.map(emp => {
                                            const attendance = dayData[emp.id] || { status: 'present', reason: '' };
                                            const statusClass = `status-${attendance.status}`;
                                            return `
                                                <tr>
                                                    <td>
                                                        <div class="employee-info">
                                                            <img src="${emp.avatar}" alt="${emp.name}" class="employee-avatar">
                                                            <div class="employee-details">
                                                                <h4>${emp.name}</h4>
                                                                <span>${emp.position}</span>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td>${emp.department}</td>
                                                    <td><span class="status-badge ${statusClass}">${attendance.status}</span></td>
                                                    <td>${attendance.reason || '-'}</td>
                                                </tr>
                                            `;
                                        }).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function closeHistoryDetail() {
            const modal = document.getElementById('historyDetailModal');
            if (modal) {
                modal.remove();
            }
        }

        // Export functions
        function exportToCSV() {
            const todayData = attendanceData[currentDate] || {};
            const csvData = [];
            
            // Headers
            csvData.push(['Employee ID', 'Name', 'Department', 'Position', 'Status', 'Reason', 'Date'].join(','));
            
            // Data
            employees.forEach(emp => {
                const attendance = todayData[emp.id] || { status: 'present', reason: '' };
                csvData.push([
                    emp.id,
                    emp.name,
                    emp.department,
                    emp.position,
                    attendance.status,
                    attendance.reason,
                    currentDate
                ].join(','));
            });
            
            // Download
            downloadCSV(csvData.join('\n'), `attendance_${currentDate}.csv`);
            showToast('Attendance data exported!', 'success');
        }

        function exportHistory() {
            const fromDate = document.getElementById('fromDate').value;
            const toDate = document.getElementById('toDate').value;
            
            if (!fromDate || !toDate) {
                showToast('Please select date range', 'error');
                return;
            }
            
            const csvData = [];
            csvData.push(['Date', 'Employee ID', 'Name', 'Department', 'Status', 'Reason'].join(','));
            
            const startDate = new Date(fromDate);
            const endDate = new Date(toDate);
            
            for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
                const dateStr = d.toISOString().split('T')[0];
                const dayData = attendanceData[dateStr] || {};
                
                employees.forEach(emp => {
                    const attendance = dayData[emp.id] || { status: 'present', reason: '' };
                    csvData.push([
                        dateStr,
                        emp.id,
                        emp.name,
                        emp.department,
                        attendance.status,
                        attendance.reason
                    ].join(','));
                });
            }
            
            downloadCSV(csvData.join('\n'), `attendance_history_${fromDate}_to_${toDate}.csv`);
            showToast('History data exported!', 'success');
        }

        function downloadCSV(content, filename) {
            const blob = new Blob([content], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved data
            loadData();
            
            // Initialize today's attendance
            initializeTodayAttendance();
            
            // Sidebar toggle
            document.getElementById('sidebarToggle').addEventListener('click', function() {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.toggle('collapsed');
                
                // Change icon based on state
                const icon = this.querySelector('i');
                if (sidebar.classList.contains('collapsed')) {
                    icon.className = 'fas fa-chevron-right';
                } else {
                    icon.className = 'fas fa-chevron-left';
                }
            });

            // Mobile menu
            document.getElementById('mobileMenuBtn').addEventListener('click', function() {
                const sidebar = document.getElementById('sidebar');
                const overlay = document.getElementById('mobileOverlay');
                sidebar.classList.add('mobile-open');
                overlay.classList.add('active');
            });

            document.getElementById('mobileOverlay').addEventListener('click', function() {
                const sidebar = document.getElementById('sidebar');
                const overlay = document.getElementById('mobileOverlay');
                sidebar.classList.remove('mobile-open');
                overlay.classList.remove('active');
            });
            
            // Navigation items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                    
                    const page = this.dataset.page;
                    switchPage(page);
                    
                    // Close mobile menu
                    document.getElementById('sidebar').classList.remove('mobile-open');
                    document.getElementById('mobileOverlay').classList.remove('active');
                });
            });
            
            // Date picker with validation
            document.getElementById('attendanceDate').addEventListener('change', function() {
                const { today, maxDate } = getDateLimits();
                const selectedDate = this.value;
                
                if (selectedDate > maxDate) {
                    this.value = maxDate;
                    showToast('Cannot select date beyond ' + new Date(maxDate).toLocaleDateString(), 'warning');
                    return;
                }
                
                currentDate = this.value;
                
                // Initialize attendance for the selected date if not exists
                if (!attendanceData[currentDate]) {
                    attendanceData[currentDate] = {};
                    employees.forEach(emp => {
                        attendanceData[currentDate][emp.id] = {
                            status: 'present',
                            reason: '',
                            timestamp: new Date().toISOString()
                        };
                    });
                }
                
                updateCurrentDateDisplay();
                updateDashboardStats();
                renderEmployeeTable();
            });
            
            // Search and filters
document.getElementById('searchEmployee').addEventListener('input', renderEmployeeTable);
document.getElementById('departmentFilter').addEventListener('change', renderEmployeeTable);
document.getElementById('statusFilter').addEventListener('change', renderEmployeeTable);

// Extra filters for Employees / Interns pages
if (document.getElementById('departmentFilter2')) {
    document.getElementById('departmentFilter2').addEventListener('change', renderEmployeesTable);
}
if (document.getElementById('departmentFilter3')) {
    document.getElementById('departmentFilter3').addEventListener('change', renderInternsTable);
}

/* ---------- MODAL HELPERS ---------- */
function closeModal(node) {
    if (node) node.classList.remove('active');
}
document.querySelectorAll('.close-modal').forEach(btn => {
    btn.addEventListener('click', function () {
        closeModal(this.closest('.modal'));
    });
});
document.querySelectorAll('.modal').forEach(m => {
    m.addEventListener('click', e => {
        if (e.target === m) closeModal(m);
    });
});

/* ---------- AUTHENTICATION ---------- */
document.getElementById('authenticateBtn').addEventListener('click', handleAuthentication);

/* ---------- ABSENT MODAL ---------- */
['markAbsentBtn', 'markAbsentBtn2'].forEach(id =>
    document.getElementById(id).addEventListener('click', () => {
        const select = document.getElementById('employeeSelect');
        const todayData = attendanceData[currentDate] || {};
        select.innerHTML = '<option value="">Select an employee</option>' +
            employees
                .filter(e => {
                    const at = todayData[e.id];
                    return !at || at.status === 'present';
                })
                .map(e => `<option value="${e.id}">${e.name} (${e.id})</option>`)
                .join('');
        requireAuthentication(() => {
            document.getElementById('absentModal').classList.add('active');
        });
    })
);
document.getElementById('reasonSelect').addEventListener('change', function () {
    document.getElementById('otherReasonContainer').style.display =
        this.value === 'Other' ? 'block' : 'none';
});
document.getElementById('saveAbsenceBtn').addEventListener('click', () => {
    const empId = document.getElementById('employeeSelect').value;
    const reasonSel = document.getElementById('reasonSelect').value;
    const other = document.getElementById('otherReason').value.trim();
    if (!empId || !reasonSel) return showToast('Select employee & reason', 'error');
    const reason = reasonSel === 'Other' ? other : reasonSel;
    const status = reasonSel === 'Work From Home' ? 'wfh' : 'absent';

    if (!attendanceData[currentDate]) attendanceData[currentDate] = {};
    attendanceData[currentDate][empId] = {
        status,
        reason,
        timestamp: new Date().toISOString()
    };
    updateLeaveUsage(empId, reason);
    updateDashboardStats();
    renderEmployeeTable();
    saveData();
    closeModal(document.getElementById('absentModal'));
    showToast('Status updated', 'success');
});

/* ---------- ALL-PRESENT BUTTON ---------- */
['allPresentBtn', 'allPresentBtn2'].forEach(id =>
    document.getElementById(id).addEventListener('click', () => {
        if (!confirm('Mark EVERYONE present?')) return;
        if (!attendanceData[currentDate]) attendanceData[currentDate] = {};
        employees.forEach(e => {
            attendanceData[currentDate][e.id] = {
                status: 'present',
                reason: '',
                timestamp: new Date().toISOString()
            };
        });
        updateDashboardStats();
        renderEmployeeTable();
        saveData();
        showToast('All present', 'success');
    })
);

/* ---------- ADD / EDIT EMPLOYEE ---------- */
['addEmployeeBtn', 'addEmployeeBtn2'].forEach(id =>
    document.getElementById(id).addEventListener('click', () =>
        document.getElementById('addEmployeeModal').classList.add('active')
    )
);
document.getElementById('saveEmployeeBtn').addEventListener('click', () => {
    const name = empName.value.trim(),
        dep = empDepartment.value,
        pos = empPosition.value.trim(),
        jDate = empJoinDate.value;
    if (!name || !dep || !pos || !jDate) return showToast('Fill all fields', 'error');
    const newEmp = {
        id: generateId('EMP'),
        name,
        department: dep,
        position: pos,
        avatar: `https://randomuser.me/api/portraits/men/${Math.floor(Math.random() * 90) + 1}.jpg`,
        type: 'employee',
        joinDate: jDate,
        annualLeaves: {
            sickLeave: { used: 0, total: appSettings.sickLeaveLimit },
            casualLeave: { used: 0, total: appSettings.casualLeaveLimit },
            wfh: { used: 0, total: appSettings.wfhLimit }
        }
    };
    employees.push(newEmp);
    attendanceData[currentDate] ||= {};
    attendanceData[currentDate][newEmp.id] = { status: 'present', reason: '', timestamp: new Date().toISOString() };
    renderEmployeeTable();
    updateDashboardStats();
    saveData();
    closeModal(addEmployeeModal);
    showToast('Employee added', 'success');
});
document.getElementById('updateEmployeeBtn').addEventListener('click', updateEmployee);

/* ---------- ADD INTERN ---------- */
['addInternBtn', 'addInternBtn2'].forEach(id =>
    document.getElementById(id).addEventListener('click', () =>
        document.getElementById('addInternModal').classList.add('active')
    )
);
document.getElementById('saveInternBtn').addEventListener('click', () => {
    const name = internName.value.trim(),
        dep = internDepartment.value,
        dur = +internDuration.value,
        sDate = internStartDate.value;
    if (!name || !dep || !dur || !sDate) return showToast('Fill all fields', 'error');
    const newInt = {
        id: generateId('INT'),
        name,
        department: dep,
        position: `${dep} Intern`,
        avatar: `https://randomuser.me/api/portraits/women/${Math.floor(Math.random() * 90) + 1}.jpg`,
        type: 'intern',
        duration: dur,
        startDate: sDate,
        annualLeaves: {
            sickLeave: { used: 0, total: appSettings.sickLeaveLimit },
            casualLeave: { used: 0, total: appSettings.casualLeaveLimit },
            wfh: { used: 0, total: appSettings.wfhLimit }
        }
    };
    employees.push(newInt);
    attendanceData[currentDate] ||= {};
    attendanceData[currentDate][newInt.id] = { status: 'present', reason: '', timestamp: new Date().toISOString() };
    renderEmployeeTable();
    updateDashboardStats();
    saveData();
    closeModal(addInternModal);
    showToast('Intern added', 'success');
});

/* ---------- EXPORT & HISTORY ---------- */
exportBtn.addEventListener('click', exportToCSV);
exportHistoryBtn.addEventListener('click', exportHistory);
loadHistoryBtn.addEventListener('click', loadHistory);

/* ---------- SETTINGS PAGE TOGGLES ---------- */
document.querySelectorAll('.toggle-switch').forEach(sw => {
    sw.addEventListener('click', () => {
        sw.classList.toggle('active');
        appSettings[sw.dataset.setting] = sw.classList.contains('active');
        saveData();
    });
});

/* ---------- FAQ ACCORDION ---------- */
document.querySelectorAll('.faq-question').forEach(q => {
    q.addEventListener('click', () => q.nextElementSibling.classList.toggle('active'));
});
}); /* End of DOMContentLoaded */
</script>
</body>
</html>
